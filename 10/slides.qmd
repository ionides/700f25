---
title: |
  STATS 700-002 Class 10.\newline
  Variational phylodynamic inference
author:
  - Aaron King and Edward Ionides
date: 30 October 2025
date-format: long
format:
  beamer:
    cite-method: natbib
    biblio-style: apalike
    incremental: false
    slide-level: 2
    classoption: t
    aspectratio: 169
    header-includes:
      - \usepackage{amssymb}
      - \setbeamertemplate{footline}[page number]

---

## Outline

 Ki, & Terhorst (2022). Variational phylodynamic inference using pandemic-scale data. _Molecular Biology and Evolution_, 39(8), msac154. [https://doi.org/10.1093/molbev/msac154](https://doi.org/10.1093/molbev/msac154).

1. How is variational inference applied to phylodynamic models?

2. The role of automatic differentation. 


## Bayesian vs non-Bayesian phylodynamic inference

* To what extent do you agree with the assertion that phylogenetic uncertainty is not reflected in frequentist point estimates but is included in Bayesian estimates?


## Variational inference

Fourment M, Darling AE. 2019.
Evaluating probabilistic programming and fast variational Bayesian inference in phylogenetics.
[PeerJ. 7:e8272.](https://peerj.com/articles/8272/)

Fourment M, Magee AF, Whidden C, Bilge A, Matsen FA IV, Minin
VN. 2020.
19 dubious ways to compute the marginal likelihood
of a phylogenetic tree topology.
[Syst Biol. 69(2):209–220.](https://doi.org/10.1093/sysbio/syz046)

Zhang C. 2020.
Improved variational Bayesian phylogenetic inference with normalizing flows.
[Advances in neural information processing systems, Vol. 33. p. 18760–18771.](https://proceedings.neurips.cc/paper/2020/file/d96409bf894217686ba124d7356686c9-Paper.pdf)

Zhang C, Matsen FA IV. 2019. Variational Bayesian phylogenetic inference.
In 7th International Conference on Learning Representations,
[ICLR 2019; 2019 May 6–9](https://openreview.net/forum?id=SJVmjjR9FX)


## Approximations

* "A divide-and-conquer strategy where distant subtrees of a very large phylogeny are assumed to evolve approximately independently."

* "Assume that topological estimates of these subtrees are an accurate reflection of their distribution under the prior."

----

\includegraphics[height=8.3cm]{ki22-fig1.png}


## Fig 1

* This is to validate VBSKY on a problem that BEAST can also handle. VSBKY can handle many problems outside the scale of BEAST, and in that case we cannot make direct comparison.

* Which method is more accurate in these examples? How do you determine this?

----

\includegraphics[height=8.3cm]{ki22-fig2.png}

## Fig 2

* What is _biased sampling_ and how/why was it done?


----

\includegraphics[height=8.3cm]{ki22-fig3.png}

## Fig 3, Strain dynamics

The model has a prior on $R$ that is time-invariant. For example,
"Since $R>1$ is not a reasonable prior assumption for a strain which is known to have vanished, we shrank the prior distribution towards zero to attenuate this effect."
 What is the scientific challenge for interpreting inferred $R$ values to learn about the biology?


## Molecular clocks

The paper uses a "strict molecular clock" model (page 9). What is this, and what are the consequences of that decision?

## Heuristics

* Developing demonstrably good approximations that enable quantitative analysis of large populations is a useful scientific task. Statistical mechanics for ideal gasses is a classic example.

__Heuristic 1.__ Conditional independence of disjoint parts of the tree.
   Here, we take random sub-samples.

__Heuristic 2.__ Topology is approximately independent of the sequence data, given the parameters. We can separate estimation of the topology (from any scalable tree estimation method) from estimation of the branch lengths.

* Separating the topology provides a continuous problem, amenable to a variational approximation.





